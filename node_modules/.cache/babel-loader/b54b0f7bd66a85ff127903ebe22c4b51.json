{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar React = require(\"react\");\n\nvar PropTypes = require(\"prop-types\");\n\nvar core_1 = require(\"../../../../../core\");\n\nvar ui_1 = require(\"../../../../ui\");\n\nvar defaults = require(\"lodash/defaults\");\n\nvar map = require(\"lodash/map\");\n\nvar identity = require(\"lodash/identity\");\n\nvar HierarchicalMenuFilter =\n/** @class */\nfunction (_super) {\n  __extends(HierarchicalMenuFilter, _super);\n\n  function HierarchicalMenuFilter() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  HierarchicalMenuFilter.prototype.defineBEMBlocks = function () {\n    var blockClass = this.props.mod || \"sk-hierarchical-menu\";\n    return {\n      container: blockClass + \"-list\",\n      option: blockClass + \"-option\"\n    };\n  };\n\n  HierarchicalMenuFilter.prototype.defineAccessor = function () {\n    var _a = this.props,\n        id = _a.id,\n        title = _a.title,\n        fields = _a.fields,\n        size = _a.size,\n        orderKey = _a.orderKey,\n        orderDirection = _a.orderDirection;\n    return new core_1.HierarchicalFacetAccessor(id, {\n      id: id,\n      title: title,\n      fields: fields,\n      size: size,\n      orderKey: orderKey,\n      orderDirection: orderDirection\n    });\n  };\n\n  HierarchicalMenuFilter.prototype.addFilter = function (option, level) {\n    this.accessor.state = this.accessor.state.toggleLevel(level, option.key);\n    this.searchkit.performSearch();\n  };\n\n  HierarchicalMenuFilter.prototype.renderOption = function (level, option) {\n    var _this = this;\n\n    var block = this.bemBlocks.option;\n    var _a = this.props,\n        countFormatter = _a.countFormatter,\n        itemComponent = _a.itemComponent;\n    var active = this.accessor.state.contains(level, option.key);\n    return React.createElement(\"div\", {\n      key: option.key\n    }, core_1.renderComponent(itemComponent, {\n      active: active,\n      itemKey: option.key,\n      showCount: true,\n      bemBlocks: this.bemBlocks,\n      onClick: this.addFilter.bind(this, option, level),\n      label: this.translate(option.key),\n      count: countFormatter(option.doc_count)\n    }), function () {\n      if (_this.accessor.resultsState.contains(level, option.key)) {\n        return _this.renderOptions(level + 1);\n      }\n    }());\n  };\n\n  HierarchicalMenuFilter.prototype.renderOptions = function (level) {\n    var block = this.bemBlocks.container;\n    return React.createElement(\"div\", {\n      className: block(\"hierarchical-options\")\n    }, map(this.accessor.getBuckets(level), this.renderOption.bind(this, level)));\n  };\n\n  HierarchicalMenuFilter.prototype.render = function () {\n    if (!this.accessor) return null;\n    var block = this.bemBlocks.container;\n    var _a = this.props,\n        id = _a.id,\n        title = _a.title,\n        containerComponent = _a.containerComponent;\n    return core_1.renderComponent(containerComponent, {\n      title: title,\n      className: id ? \"filter--\" + id : undefined,\n      disabled: this.accessor.getBuckets(0).length == 0\n    }, React.createElement(\"div\", {\n      className: block(\"root\")\n    }, this.renderOptions(0)));\n  };\n\n  HierarchicalMenuFilter.defaultProps = {\n    countFormatter: identity,\n    size: 20,\n    containerComponent: ui_1.Panel,\n    itemComponent: ui_1.ItemComponent\n  };\n  HierarchicalMenuFilter.propTypes = defaults({\n    id: PropTypes.string.isRequired,\n    fields: PropTypes.arrayOf(PropTypes.string).isRequired,\n    title: PropTypes.string.isRequired,\n    orderKey: PropTypes.string,\n    orderDirection: PropTypes.oneOf([\"asc\", \"desc\"]),\n    countFormatter: PropTypes.func,\n    containerComponent: core_1.RenderComponentPropType,\n    itemComponent: core_1.RenderComponentPropType\n  }, core_1.SearchkitComponent.propTypes);\n  return HierarchicalMenuFilter;\n}(core_1.SearchkitComponent);\n\nexports.HierarchicalMenuFilter = HierarchicalMenuFilter;","map":null,"metadata":{},"sourceType":"script"}
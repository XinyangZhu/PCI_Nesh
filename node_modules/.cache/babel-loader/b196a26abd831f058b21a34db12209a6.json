{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar PropTypes = require(\"prop-types\");\n\nvar core_1 = require(\"../../../../core\");\n\nvar ui_1 = require(\"../../../ui\");\n\nvar defaults = require(\"lodash/defaults\");\n\nvar get = require(\"lodash/get\");\n\nvar identity = require(\"lodash/identity\");\n\nvar DynamicRangeFilter =\n/** @class */\nfunction (_super) {\n  __extends(DynamicRangeFilter, _super);\n\n  function DynamicRangeFilter(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.sliderUpdate = _this.sliderUpdate.bind(_this);\n    _this.sliderUpdateAndSearch = _this.sliderUpdateAndSearch.bind(_this);\n    return _this;\n  }\n\n  DynamicRangeFilter.prototype.defineAccessor = function () {\n    var _a = this.props,\n        id = _a.id,\n        title = _a.title,\n        field = _a.field,\n        fieldOptions = _a.fieldOptions,\n        rangeFormatter = _a.rangeFormatter,\n        translations = _a.translations;\n    return new core_1.DynamicRangeAccessor(id, {\n      id: id,\n      title: title,\n      field: field,\n      fieldOptions: fieldOptions,\n      rangeFormatter: rangeFormatter,\n      translations: translations\n    });\n  };\n\n  DynamicRangeFilter.prototype.defineBEMBlocks = function () {\n    var block = this.props.mod || \"sk-dynamic-range-filter\";\n    return {\n      container: block,\n      labels: block + \"-value-labels\"\n    };\n  };\n\n  DynamicRangeFilter.prototype.getMinMax = function () {\n    return {\n      min: this.accessor.getStat(\"min\") || 0,\n      max: this.accessor.getStat(\"max\") || 0\n    };\n  };\n\n  DynamicRangeFilter.prototype.sliderUpdate = function (newValues) {\n    var _a = this.getMinMax(),\n        min = _a.min,\n        max = _a.max;\n\n    if (newValues.min == min && newValues.max == max) {\n      this.accessor.state = this.accessor.state.clear();\n    } else {\n      this.accessor.state = this.accessor.state.setValue(newValues);\n    }\n\n    this.forceUpdate();\n  };\n\n  DynamicRangeFilter.prototype.sliderUpdateAndSearch = function (newValues) {\n    this.sliderUpdate(newValues);\n    this.searchkit.performSearch();\n  };\n\n  DynamicRangeFilter.prototype.render = function () {\n    if (!this.accessor) return null;\n    var _a = this.props,\n        id = _a.id,\n        title = _a.title,\n        containerComponent = _a.containerComponent;\n    return core_1.renderComponent(containerComponent, {\n      title: title,\n      className: id ? \"filter--\" + id : undefined,\n      disabled: this.accessor.isDisabled()\n    }, this.renderRangeComponent(this.props.rangeComponent));\n  };\n\n  DynamicRangeFilter.prototype.renderRangeComponent = function (component) {\n    var _a = this.getMinMax(),\n        min = _a.min,\n        max = _a.max;\n\n    var rangeFormatter = this.props.rangeFormatter;\n    var state = this.accessor.state.getValue();\n    return core_1.renderComponent(component, {\n      min: min,\n      max: max,\n      minValue: Number(get(state, \"min\", min)),\n      maxValue: Number(get(state, \"max\", max)),\n      rangeFormatter: rangeFormatter,\n      onChange: this.sliderUpdate,\n      onFinished: this.sliderUpdateAndSearch\n    });\n  };\n\n  DynamicRangeFilter.propTypes = defaults({\n    field: PropTypes.string.isRequired,\n    title: PropTypes.string.isRequired,\n    id: PropTypes.string.isRequired,\n    containerComponent: core_1.RenderComponentPropType,\n    rangeComponent: core_1.RenderComponentPropType,\n    rangeFormatter: PropTypes.func,\n    fieldOptions: PropTypes.shape({\n      type: PropTypes.oneOf([\"embedded\", \"nested\", \"children\"]).isRequired,\n      options: PropTypes.object\n    })\n  }, core_1.SearchkitComponent.propTypes);\n  DynamicRangeFilter.defaultProps = {\n    containerComponent: ui_1.Panel,\n    rangeComponent: ui_1.RangeSlider,\n    rangeFormatter: identity\n  };\n  return DynamicRangeFilter;\n}(core_1.SearchkitComponent);\n\nexports.DynamicRangeFilter = DynamicRangeFilter;","map":null,"metadata":{},"sourceType":"script"}
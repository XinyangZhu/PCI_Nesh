{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar PropTypes = require(\"prop-types\");\n\nvar core_1 = require(\"../../../../../core\");\n\nvar ui_1 = require(\"../../../../ui\");\n\nvar defaults = require(\"lodash/defaults\");\n\nvar get = require(\"lodash/get\");\n\nvar RangeFilter =\n/** @class */\nfunction (_super) {\n  __extends(RangeFilter, _super);\n\n  function RangeFilter(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.sliderUpdate = _this.sliderUpdate.bind(_this);\n    _this.sliderUpdateAndSearch = _this.sliderUpdateAndSearch.bind(_this);\n    return _this;\n  }\n\n  RangeFilter.prototype.defineAccessor = function () {\n    var _a = this.props,\n        id = _a.id,\n        title = _a.title,\n        min = _a.min,\n        max = _a.max,\n        field = _a.field,\n        fieldOptions = _a.fieldOptions,\n        interval = _a.interval,\n        showHistogram = _a.showHistogram,\n        rangeFormatter = _a.rangeFormatter,\n        translations = _a.translations;\n    return new core_1.RangeAccessor(id, {\n      id: id,\n      min: min,\n      max: max,\n      title: title,\n      field: field,\n      rangeFormatter: rangeFormatter,\n      translations: translations,\n      interval: interval,\n      loadHistogram: showHistogram,\n      fieldOptions: fieldOptions\n    });\n  };\n\n  RangeFilter.prototype.defineBEMBlocks = function () {\n    var block = this.props.mod || \"sk-range-filter\";\n    return {\n      container: block,\n      labels: block + \"-value-labels\"\n    };\n  };\n\n  RangeFilter.prototype.sliderUpdate = function (newValues) {\n    if (newValues.min == this.props.min && newValues.max == this.props.max) {\n      this.accessor.state = this.accessor.state.clear();\n    } else {\n      this.accessor.state = this.accessor.state.setValue(newValues);\n    }\n\n    this.forceUpdate();\n  };\n\n  RangeFilter.prototype.sliderUpdateAndSearch = function (newValues) {\n    this.sliderUpdate(newValues);\n    this.searchkit.performSearch();\n  };\n\n  RangeFilter.prototype.getRangeComponent = function () {\n    var _a = this.props,\n        rangeComponent = _a.rangeComponent,\n        showHistogram = _a.showHistogram;\n\n    if (!showHistogram && rangeComponent === ui_1.RangeSliderHistogram) {\n      return ui_1.RangeSlider;\n    } else {\n      return rangeComponent;\n    }\n  };\n\n  RangeFilter.prototype.render = function () {\n    if (!this.accessor) return null;\n    var _a = this.props,\n        id = _a.id,\n        title = _a.title,\n        containerComponent = _a.containerComponent;\n    return core_1.renderComponent(containerComponent, {\n      title: title,\n      className: id ? \"filter--\" + id : undefined,\n      disabled: this.accessor.isDisabled()\n    }, this.renderRangeComponent(this.getRangeComponent()));\n  };\n\n  RangeFilter.prototype.renderRangeComponent = function (component) {\n    var _a = this.props,\n        min = _a.min,\n        max = _a.max,\n        rangeFormatter = _a.rangeFormatter,\n        marks = _a.marks;\n    var state = this.accessor.state.getValue();\n    return core_1.renderComponent(component, {\n      min: min,\n      max: max,\n      minValue: Number(get(state, \"min\", min)),\n      maxValue: Number(get(state, \"max\", max)),\n      items: this.accessor.getBuckets(),\n      onChange: this.sliderUpdate,\n      onFinished: this.sliderUpdateAndSearch,\n      rangeFormatter: rangeFormatter,\n      marks: marks\n    });\n  };\n\n  RangeFilter.propTypes = defaults({\n    field: PropTypes.string.isRequired,\n    title: PropTypes.string.isRequired,\n    id: PropTypes.string.isRequired,\n    containerComponent: core_1.RenderComponentPropType,\n    rangeComponent: core_1.RenderComponentPropType,\n    fieldOptions: PropTypes.shape({\n      type: PropTypes.oneOf([\"embedded\", \"nested\", \"children\"]).isRequired,\n      options: PropTypes.object\n    }),\n    rangeFormatter: PropTypes.func,\n    marks: PropTypes.object\n  }, core_1.SearchkitComponent.propTypes);\n  RangeFilter.defaultProps = {\n    containerComponent: ui_1.Panel,\n    rangeComponent: ui_1.RangeSliderHistogram,\n    showHistogram: true\n  };\n  return RangeFilter;\n}(core_1.SearchkitComponent);\n\nexports.RangeFilter = RangeFilter;","map":null,"metadata":{},"sourceType":"script"}